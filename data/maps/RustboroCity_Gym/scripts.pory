raw `

.set LOCALID_GYMGUIDE, 4

RustboroCity_Gym_MapScripts::
	map_script MAP_SCRIPT_ON_TRANSITION, RustboroCity_Gym_On_Transition
	.byte 0

RustboroCity_Gym_On_Transition:
	call DewfordTown_Gym_EventScript_SetFlashLevel6
	call_if_eq VAR_LITTLEROOT_TOWN_STATE, 0, DarkwingGrove_EventScript_MoveGuideToStairs
	end

RustboroCity_Gym_EventScript_RoxanneRematch::
	trainerbattle_rematch_double TRAINER_ROXANNE_1, RustboroCity_Gym_Text_RoxannePreRematch, RustboroCity_Gym_Text_RoxanneRematchDefeat, RustboroCity_Gym_Text_RoxanneRematchNeedTwoMons
	msgbox RustboroCity_Gym_Text_RoxannePostRematch, MSGBOX_AUTOCLOSE
	end

RustboroCity_Gym_EventScript_Josh::
	trainerbattle_single TRAINER_JOSH, RustboroCity_Gym_Text_JoshIntro, RustboroCity_Gym_Text_JoshDefeat
	msgbox RustboroCity_Gym_Text_JoshPostBattle, MSGBOX_AUTOCLOSE
	end

RustboroCity_Gym_EventScript_Marc::
	trainerbattle_single TRAINER_MARC, RustboroCity_Gym_Text_MarcIntro, RustboroCity_Gym_Text_MarcDefeat
	msgbox RustboroCity_Gym_Text_MarcPostBattle, MSGBOX_AUTOCLOSE
	end

RustboroCity_Gym_EventScript_LeftGymStatue::
	lockall
	goto_if_set FLAG_BADGE01_GET, RustboroCity_Gym_EventScript_GymStatueCertified
	goto RustboroCity_Gym_EventScript_GymStatue
	end

RustboroCity_Gym_EventScript_RightGymStatue::
	lockall
	goto_if_set FLAG_BADGE01_GET, RustboroCity_Gym_EventScript_GymStatueCertified
	goto RustboroCity_Gym_EventScript_GymStatue
	end

RustboroCity_Gym_EventScript_GymStatueCertified::
	msgbox RustboroCity_Gym_Text_GymStatueCertified, MSGBOX_DEFAULT
	releaseall
	end

RustboroCity_Gym_EventScript_GymStatue::
	msgbox RustboroCity_Gym_Text_GymStatue, MSGBOX_DEFAULT
	releaseall
	end

RustboroCity_Gym_EventScript_RegisterRoxanne::
	lockall
	pokenavcall RustboroCity_Gym_Text_RoxanneRegisterCall
	waitmessage
	delay 30
	playfanfare MUS_REGISTER_MATCH_CALL
	msgbox RustboroCity_Gym_Text_RegisteredRoxanne, MSGBOX_DEFAULT
	waitfanfare
	closemessage
	delay 30
	setflag FLAG_ENABLE_ROXANNE_MATCH_CALL
	clearflag FLAG_ENABLE_ROXANNE_FIRST_CALL
	releaseall
	end

RustboroCity_Gym_Text_JoshIntro:
	.string "Midnite is a wonderful mentor.\n"
	.string "Even for an old guy like me!$"

RustboroCity_Gym_Text_JoshDefeat:
	.string "I just got schooled…$"

RustboroCity_Gym_Text_JoshPostBattle:
	.string "You might be strong, but Midnite\n"
	.string "is the strongest!$"

RustboroCity_Gym_Text_MarcIntro:
	.string "Even in the middle of nowhere,\n"
	.string "Rika has a Gym!\p"
	.string "How cool is that?$"

RustboroCity_Gym_Text_MarcDefeat:
	.string "Even in the middle of nowhere,\n"
	.string "I lost!$"

RustboroCity_Gym_Text_MarcPostBattle:
	.string "Even in the middle of nowhere,\n"
	.string "I lost!\p"
	.string "How lame is that?$"

RustboroCity_Gym_Text_GymStatue:
	.string "RUSTBORO CITY POKéMON GYM$"

RustboroCity_Gym_Text_GymStatueCertified:
	.string "RUSTBORO CITY POKéMON GYM\p"
	.string "ROXANNE'S CERTIFIED TRAINERS:\n"
	.string "{PLAYER}$"

RustboroCity_Gym_Text_RoxanneRegisterCall:
	.string "… … … … … …\n"
	.string "… … … … … Beep!\p"
	.string "ROXANNE: Oh, hello, {PLAYER}?\n"
	.string "This is ROXANNE of RUSTBORO CITY.\p"
	.string "I heard from BRAWLY that you're\n"
	.string "moving up through the ranks of\l"
	.string "TRAINERS at an incredible clip.\p"
	.string "Well, I'd rather not think that\n"
	.string "I can't beat you.\p"
	.string "I promise, I will shape up my GYM\n"
	.string "so that you may challenge us again.\p"
	.string "I hope you'll be looking forward to\n"
	.string "that occasion as much as me!\p"
	.string "… … … … … …\n"
	.string "… … … … … Click!$"

RustboroCity_Gym_Text_RegisteredRoxanne:
	.string "Registered GYM LEADER ROXANNE\n"
	.string "in the POKéNAV.$"

RustboroCity_Gym_Text_RoxannePreRematch:
	.string "ROXANNE: I'm so glad to see you again.\n"
	.string "I'm ROXANNE, the GYM LEADER here.\p"
	.string "I'm sure we've both experienced many\n"
	.string "battles since we last met.\p"
	.string "I would like to see how much better\n"
	.string "we've become. Let us battle!$"

RustboroCity_Gym_Text_RoxanneRematchDefeat:
	.string "Grr…\n"
	.string "Again, I have lost…$"

RustboroCity_Gym_Text_RoxannePostRematch:
	.string "ROXANNE: I still have much to learn\n"
	.string "when it comes to battling POKéMON.\p"
	.string "That awareness makes me love battling\n"
	.string "all that much more!$"

RustboroCity_Gym_Text_RoxanneRematchNeedTwoMons:
	.string "ROXANNE: I'm so glad to see you again.\n"
	.string "I'm ROXANNE, the GYM LEADER here.\p"
	.string "I'm sure we've both experienced many\n"
	.string "battles since we last met.\p"
	.string "I would like to see how much better\n"
	.string "we've become…\p"
	.string "Oh, no…\n"
	.string "You only have one POKéMON with you?\p"
	.string "Please return with at least one more\n"
	.string "POKéMON.$"
`

script DarkwingGrove_Gym_EventScript_Roxanne {
	trainerbattle_single(TRAINER_ROXANNE_1, DarkwingGrove_Gym_Text_RoxanneIntro, DarkwingGrove_Gym_Text_RoxanneDefeat, DarkwingGrove_Gym_EventScript_RoxanneDefeated, NO_MUSIC)
	specialvar(VAR_RESULT, ShouldTryRematchBattle)
	goto_if_eq(VAR_RESULT, TRUE, RustboroCity_Gym_EventScript_RoxanneRematch)
	goto_if_unset(FLAG_RECEIVED_TM_ROCK_TOMB, DarkwingGrove_Gym_EventScript_GiveSnatch)
	msgbox(DarkwingGrove_Gym_Text_RoxannePostBattle, MSGBOX_DEFAULT)
	release
}

script DarkwingGrove_Gym_EventScript_RoxanneDefeated {
	message(DarkwingGrove_Gym_Text_ReceivedStoneBadge)
	waitmessage
	call(Common_EventScript_PlayGymBadgeFanfare)
	msgbox(DarkwingGrove_Gym_Text_StoneBadgeInfoTakeThis, MSGBOX_DEFAULT)
	setflag(FLAG_DEFEATED_RUSTBORO_GYM)
	setflag(FLAG_BADGE01_GET)
	setvar(VAR_LITTLEROOT_TOWN_STATE, 2)
	setvar(VAR_0x8008, 1)
	call(Common_EventScript_SetGymTrainers)
	goto(DarkwingGrove_Gym_EventScript_GiveSnatch)
}

script DarkwingGrove_Gym_EventScript_GiveSnatch {
	giveitem(ITEM_TM_SNATCH)
	goto_if_eq(VAR_RESULT, FALSE, Common_EventScript_ShowBagIsFull)
	setflag(FLAG_RECEIVED_TM_ROCK_TOMB)
	msgbox(DarkwingGrove_Gym_Text_ExplainRockTomb, MSGBOX_DEFAULT)
	release
}

script DarkwingGrove_Gym_EventScript_GymGuide {
	lock
	faceplayer
	if(flag(FLAG_DEFEATED_RUSTBORO_GYM) == TRUE) {
		msgbox(DarkwingGrove_Gym_Text_GymGuidePostVictory, MSGBOX_DEFAULT)
		closemessage
	} elif (var(VAR_LITTLEROOT_TOWN_STATE) == 0) {
		msgbox(DarkwingGrove_Gym_Text_GymGuideEarly, MSGBOX_DEFAULT)
		closemessage()
		if (var(VAR_FACING) == DIR_EAST) {
			applymovement(LOCALID_GYMGUIDE, DarkwingGrove_Gym_Movement_MoveGuideEast)
			waitmovement(0)
		} else {
			applymovement(LOCALID_GYMGUIDE, DarkwingGrove_Gym_Movement_MoveGuideSouthWest)
			waitmovement(0)
		}
		setvar(VAR_LITTLEROOT_TOWN_STATE, 1)
	} else {
		msgbox(DarkwingGrove_Gym_Text_GymGuideAdvice, MSGBOX_DEFAULT)
		closemessage
	}
	release
}

script DarkwingGrove_EventScript_MoveGuideToStairs {
	setobjectxyperm(LOCALID_GYMGUIDE, 5, 15)
}

script DarkwingGrove_Gym_EventScript_Tommy {
	trainerbattle_single(TRAINER_TOMMY, DarkwingGrove_Gym_Text_TommyIntro, DarkwingGrove_Gym_Text_TommyDefeat)
	msgbox(DarkwingGrove_Gym_Text_TommyPostBattle, MSGBOX_AUTOCLOSE)
}

movement DarkwingGrove_Gym_Movement_MoveGuideEast {
	walk_down
	walk_right * 2
	walk_up * 2
	walk_in_place_down
}

movement DarkwingGrove_Gym_Movement_MoveGuideSouthWest {
	walk_right * 2
	walk_up
	walk_in_place_down
}

text DarkwingGrove_Gym_Text_GymGuideEarly {
	format("Hey, {PLAYER}! Welcome to the Rika League!\p"
	"I'll be your guide for this Gym. Because I know you personally, I also happen to know you just got your Pokémon.\p"
	"Now, you have an eligible party. I can't officially stop you from competing.\p"
	"But heed this warning!\p"
	"Your Mom is a tough opponent. If you haven't sufficiently trained, you'll likely lose this fight.\p"
	"I'll let you pass. But don't say I didn't warn you!")
}

text DarkwingGrove_Gym_Text_GymGuideAdvice {
	format("Midnite is ruthless. She battles with Dark-type Pokémon, so you should be sure to keep Psychic and Ghost types out of her way.\p"
	"She's talented, {PLAYER}. Her team has a lot of trickery you might not be used to. Be on guard!")
}

text DarkwingGrove_Gym_Text_GymGuidePostVictory {
	format("Way to go, {PLAYER}! We'll be sure to send all your battle data to the Rika League officials. Keep it up!")
}

text DarkwingGrove_Gym_Text_TommyIntro {
	format("Yo! You think you've got what it takes to beat Midnite?")
}

text DarkwingGrove_Gym_Text_TommyDefeat{
	format("Wow! That was rough!")
}

text DarkwingGrove_Gym_Text_TommyPostBattle{
	format("Midnite is your Mom? No wonder you're so strong!")
}

text DarkwingGrove_Gym_Text_RoxanneIntro {
	format("Mom: Hi, {PLAYER}.\p"
	"It makes me so proud to finally see you standing here, on my mat, in my Gym!\p"
	"But I should warn you, {PLAYER}. As an official Gym Leader for the Rika League, I have a duty to push my Pokémon to their limits.\p"
	"Battling is about trust, understanding, and cooperation. You may understand this, but you don't have the experience that we do. You don't have the bond we do.\p"
	"Go ahead, {PLAYER}. Prove me wrong…\p"
	"Or be overwhelmed by darkness!")
}

text DarkwingGrove_Gym_Text_RoxanneDefeat {
	format("Mom: I lost…\p"
	"{PLAYER}, amazing job!\p"
	"You and your Pokémon truly understand each other.\p"
	"Against all odds, you've proven yourself a fine Trainer.\p"
	"Please, on behalf of the Rika League, accept this official Somber Badge!")
}

text DarkwingGrove_Gym_Text_ReceivedStoneBadge{
	format("{PLAYER} received the Somber Badge from Mom!$")
}

text DarkwingGrove_Gym_Text_StoneBadgeInfoTakeThis{
	format("Mom: The Somber Badge is the first of many, {PLAYER}!\p"
	"You've earned this, too.")
}

text DarkwingGrove_Gym_Text_ExplainRockTomb {
	format("Mom: That TM contains Snatch. It's a really tricky move!\p"
	"Snatch always goes first. It lets your Pokémon steal a beneficial Status move an opponent plans to use that turn, letting you use it instead."
	"I hope it helps you on your journey, {PLAYER}!")
}

text DarkwingGrove_Gym_Text_RoxannePostBattle{
	format("Mom: You've really grown already, {PLAYER}.\p"
	"I couldn't be more proud of you and your Pokémon.")
}